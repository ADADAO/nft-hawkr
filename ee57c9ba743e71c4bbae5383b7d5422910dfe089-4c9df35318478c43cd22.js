"use strict";(self.webpackChunknft_hawkr=self.webpackChunknft_hawkr||[]).push([[524],{2226:function(a,e){var t={PROJECT_ID:"testnetL0riA5tMipy3cQ45FjldsEdTSTuClr8V"};e.Z=t},4832:function(a,e,t){t.d(e,{Z:function(){return S}});var r=t(5861),n=t(7757),c=t.n(n),d=t(2081),s=t(3427),o=t(2982),u="undefined"!=typeof window&&window.BigInt,i=null,f={setProtocolParameters:function(a,e,t,r){i={minUTxO:a,minFeeA:e,minFeeB:t,maxTxSize:r}},randomImprove:function(a,e,t,r){if(void 0===r&&(r=[]),!i)throw new Error("Protocol parameters not set. Use setProtocolParameters().");for(var n=u(e.len())*u(i.minUTxO),c=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")),s=0;s<r.length;s++)c=_(r[s].output().amount(),c);for(var f={selection:(0,o.Z)(r),remaining:(0,o.Z)(a),subset:[],amount:c},l=function(a){for(var e=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")),t=0;t<a.len();t++)e=_(a.get(t).amount(),e);return e}(e),h=function(a){var e=[];if(a.multiasset())for(var t=a.multiasset(),r=0;r<t.keys().len();r++)for(var n=t.keys().get(r),c=0;c<t.get(n).keys().len();c++){var s=d.Z.Cardano.Assets.new(),o=t.get(n).keys().get(c);s.insert(d.Z.Cardano.AssetName.from_bytes(o.to_bytes()),d.Z.Cardano.BigNum.from_bytes(t.get(n).get(o).to_bytes()));var u=d.Z.Cardano.MultiAsset.new();u.insert(d.Z.Cardano.ScriptHash.from_bytes(n.to_bytes()),s);var i=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0"));i.set_multiasset(u),e.push(i)}return(e=b(e,"DESC")).push(d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_bytes(a.coin().to_bytes()))),e}(l),w=0;w<h.length;w++)C(f,h[w]),f=m(f,h[w],t,n);h=b(h);for(var g=0;g<h.length;g++){C(f,h[g]);var Z={};Z.ideal=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")).checked_add(h[g]).checked_add(h[g]),Z.maximum=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")).checked_add(Z.ideal).checked_add(h[g]),p(f,h[g],t-f.selection.length,Z)}if(f.remaining.length>0){var x=f.amount.checked_sub(l),y=d.Z.Cardano.Value.new(d.Z.Cardano.min_ada_required(x,d.Z.Cardano.BigNum.from_str(i.minUTxO))),k=u(i.minFeeA)*u(i.maxTxSize)+u(i.minFeeB);if(k=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str(k.toString())),v(x,y=y.checked_add(k))<0){var T=y.checked_sub(d.Z.Cardano.Value.new(x.coin())).checked_add(d.Z.Cardano.Value.new(f.amount.coin()));C(f,T),f=m(f,T,t,n)}}return{input:f.selection,output:e,remaining:f.remaining,amount:f.amount,change:f.amount.checked_sub(l)}}};function m(a,e,t,r){try{a=l(function(a){return{selection:Z(a.selection),remaining:Z(a.remaining),subset:Z(a.subset),amount:x(a.amount)}}(a),e,t-a.selection.length,r)}catch(n){if("INPUT_LIMIT_EXCEEDED"!==n.message)throw n;a=function(a,e,t,r){a.subset=a.subset.sort((function(a,t){return Number(w(e,t.output().amount())-w(e,a.output().amount()))}));do{if(t<=0)throw new Error("INPUT_LIMIT_EXCEEDED");if(a.subset.length<=0){if(g(e,a.amount,0,0))throw new Error("MIN_UTXO_ERROR");throw new Error("INPUTS_EXHAUSTED")}var n=a.subset.splice(0,1).pop();a.selection.push(n),a.amount=_(n.output().amount(),a.amount),t--}while(!g(e,a.amount,r,a.subset.length-1));return a.remaining=[].concat((0,o.Z)(a.remaining),(0,o.Z)(a.subset)),a.subset=[],a}(a,e,t-a.selection.length,r)}return a}function l(a,e,t,r){var n=a.subset.length;if(g(e,a.amount,r,n))return a.remaining=[].concat((0,o.Z)(a.remaining),(0,o.Z)(a.subset)),a.subset=[],a;if(t<=0)throw new Error("INPUT_LIMIT_EXCEEDED");if(n<=0){if(g(e,a.amount,0,0))throw new Error("MIN_UTXO_ERROR");throw new Error("INPUTS_EXHAUSTED")}var c=a.subset.splice(Math.floor(Math.random()*n),1).pop();return a.selection.push(c),a.amount=_(c.output().amount(),a.amount),l(a,e,t-1,r)}function p(a,e,t,r){var n=a.subset.length;if(v(a.amount,r.ideal)>=0||n<=0||t<=0)return a.remaining=[].concat((0,o.Z)(a.remaining),(0,o.Z)(a.subset)),void(a.subset=[]);var c=a.subset.splice(Math.floor(Math.random()*n),1).pop(),s=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")).checked_add(c.output().amount()).checked_add(e);return y(h(r.ideal)-h(s))<y(h(r.ideal)-h(e))&&v(s,r.maximum)<=0?(a.selection.push(c),a.amount=_(c.output().amount(),a.amount),t--):a.remaining.push(c),p(a,e,t,r)}function _(a,e){return e.checked_add(a)}function b(a,e){return void 0===e&&(e="ASC"),a.sort((function(a,t){var r=u("DESC"===e?-1:1);return Number((h(a)-h(t))*r)}))}function h(a){var e=u(0),t=u(a.coin().to_str());if(t>0)e=t;else if(a.multiasset()&&a.multiasset().len()>0){var r=a.multiasset().keys().get(0),n=a.multiasset().get(r).keys().get(0);e=u(a.multiasset().get(r).get(n).to_str())}return e}function w(a,e){var t=u(0);if(u(a.coin().to_str())>0)t=u(e.coin().to_str());else if(a.multiasset()&&e.multiasset()&&a.multiasset().len()>0&&e.multiasset().len()>0){var r=a.multiasset().keys().get(0),n=a.multiasset().get(r).keys().get(0);t=u(e.multiasset().get(r).get(n).to_str())}return t}function C(a,e){if(u(e.coin().to_str())<u(1)){for(var t=[],r=[],n=0;n<a.remaining.length;n++)void 0!==v(a.remaining[n].output().amount(),e)?t.push(a.remaining[n]):r.push(a.remaining[n]);a.subset=t,a.remaining=r}else a.subset=a.remaining.splice(0,a.remaining.length)}function g(a,e,t,r){var n=a;if(t&&u(a.coin().to_str())>0){var c=d.Z.Cardano.Value.new(d.Z.Cardano.min_ada_required(e,d.Z.Cardano.BigNum.from_str(t.toString())));if(v(e,c)<0)return!1;if(v(a,c)<0&&(n=c.checked_add(d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str(i.minUTxO)))),r>0){var s=u(i.minFeeA)*u(i.maxTxSize)+u(i.minFeeB);s=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str(s.toString())),n=n.checked_add(s)}}return v(e,n)>=0}var Z=function(a){return a.map((function(a){return d.Z.Cardano.TransactionUnspentOutput.from_bytes(a.to_bytes())}))},x=function(a){return d.Z.Cardano.Value.from_bytes(a.to_bytes())};function y(a){return a<0?a*u(-1):a}function v(a,e){var t=u(a.coin().to_str()),r=u(e.coin().to_str());if(e.multiasset()){var n=e.multiasset().keys().get(0),c=e.multiasset().get(n).keys().get(0);if(!a.multiasset()||!a.multiasset().len())return;if(!a.multiasset().get(n)||!a.multiasset().get(n).get(c))return;t=u(a.multiasset().get(n).get(c).to_str()),r=u(e.multiasset().get(n).get(c).to_str())}return t>=r?t===r?0:1:-1}var k=f,T=function(){var a=d.Z.Cardano.PlutusScripts.new();return a.add(d.Z.Cardano.PlutusScript.new((0,s.H_)("59114159113e010000332333222332233322233223322332232323332223233322232333333332222222232333222323333222232323322323332223232323322332232323333322222332233223322332233223322223223223232533530303330083333573466e1cd55cea8032400046094646464646666ae68cdc39aab9d5003480008ccc888ccc15000c008004dd71aba150033335502775ca04c6ae854008dd71aba135744a00446a0966a609866ae71241035054310004d49926135744a00226aae7940044dd50009aba135573ca00e46a08c6a608e66ae712410350543100048499263333573466e1d40112002205323333573466e1d401520002055235047353048335738921035054310004949926498cccd5cd19b8735573aa004900011980599191919191919191919191999ab9a3370e6aae754029200023333333333019335027232323333573466e1cd55cea8012400046603e606e6ae854008c0b0d5d09aba250022350563530573357389201035054310005849926135573ca00226ea8004d5d0a80519a8138141aba150093335502e75ca05a6ae854020ccd540b9d728169aba1500733502704035742a00c66a04e66aa0a2092eb4d5d0a8029919191999ab9a3370e6aae754009200023350213232323333573466e1cd55cea80124000466a05266a07eeb4d5d0a80118221aba135744a00446a0b46a60b666ae712401035054310005c49926135573ca00226ea8004d5d0a8011919191999ab9a3370e6aae7540092000233502733503f75a6ae854008c110d5d09aba2500223505a35305b3357389201035054310005c49926135573ca00226ea8004d5d09aba250022350563530573357389201035054310005849926135573ca00226ea8004d5d0a80219a813bae35742a00666a04e66aa0a2eb88004d5d0a801181b1aba135744a00446a0a46a60a666ae71241035054310005449926135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135573ca00226ea8004d5d0a8011919191999ab9a3370ea00290031180f181c1aba135573ca00646666ae68cdc3a801240084603a60846ae84d55cf280211999ab9a3370ea00690011180e98169aba135573ca00a46666ae68cdc3a80224000460406eb8d5d09aab9e500623504d35304e3357389201035054310004f49926499264984d55cea80089baa001357426ae8940088d4118d4c11ccd5ce2490350543100048499261047135045353046335738920103505435000474984d55cf280089baa001135573a6ea80044dd50009109198008018011000911111111109199999999980080580500480400380300280200180110009109198008018011000891091980080180109000891091980080180109000891091980080180109000909111180200290911118018029091111801002909111180080290008919118011bac0013200135503b2233335573e0024a070466a06e60086ae84008c00cd5d100101811919191999ab9a3370e6aae75400d200023330073232323333573466e1cd55cea8012400046601a605c6ae854008cd40400a8d5d09aba25002235033353034335738921035054310003549926135573ca00226ea8004d5d0a801999aa805bae500a35742a00466a018eb8d5d09aba2500223502f353030335738921035054310003149926135744a00226aae7940044dd50009110919980080200180110009109198008018011000899aa800bae75a224464460046eac004c8004d540d488c8cccd55cf80112819919a81919aa81a98031aab9d5002300535573ca00460086ae8800c0ac4d5d080089119191999ab9a3370ea002900011a80418029aba135573ca00646666ae68cdc3a801240044a01046a0526a605466ae71241035054310002b499264984d55cea80089baa001121223002003112200112001232323333573466e1cd55cea8012400046600c600e6ae854008dd69aba135744a00446a0466a604866ae71241035054310002549926135573ca00226ea80048848cc00400c00880048c8cccd5cd19b8735573aa002900011bae357426aae7940088d407cd4c080cd5ce24810350543100021499261375400224464646666ae68cdc3a800a40084a00e46666ae68cdc3a8012400446a014600c6ae84d55cf280211999ab9a3370ea00690001280511a8111a981199ab9c490103505431000244992649926135573aa00226ea8004484888c00c0104488800844888004480048c8cccd5cd19b8750014800880188cccd5cd19b8750024800080188d4068d4c06ccd5ce249035054310001c499264984d55ce9baa0011220021220012001232323232323333573466e1d4005200c200b23333573466e1d4009200a200d23333573466e1d400d200823300b375c6ae854014dd69aba135744a00a46666ae68cdc3a8022400c46601a6eb8d5d0a8039bae357426ae89401c8cccd5cd19b875005480108cc048c050d5d0a8049bae357426ae8940248cccd5cd19b875006480088c050c054d5d09aab9e500b23333573466e1d401d2000230133016357426aae7940308d407cd4c080cd5ce2481035054310002149926499264992649926135573aa00826aae79400c4d55cf280109aab9e500113754002424444444600e01044244444446600c012010424444444600a010244444440082444444400644244444446600401201044244444446600201201040024646464646666ae68cdc3a800a400446660106eb4d5d0a8021bad35742a0066eb4d5d09aba2500323333573466e1d400920002300a300b357426aae7940188d4040d4c044cd5ce2490350543100012499264984d55cea80189aba25001135573ca00226ea80048488c00800c888488ccc00401401000c80048c8c8cccd5cd19b875001480088c018dd71aba135573ca00646666ae68cdc3a80124000460106eb8d5d09aab9e500423500a35300b3357389201035054310000c499264984d55cea80089baa001212230020032122300100320011122232323333573466e1cd55cea80124000466aa024600c6ae854008c014d5d09aba25002235007353008335738921035054310000949926135573ca00226ea8004498480048004848c004008800488848ccc00401000c00880044488008488488cc00401000c48004448848cc00400c0084480044880084880048004448c8c00400488cc00cc008008004cc8cc88c8c8c8ccc888c8c8c8cc88cc88ccc888ccc888cccccccc88888888cc88ccccc88888cccc8888cc88cc88cc88ccc888cc88ccc888cc88cc88cc88cc88ccc888cc88cc88cc88cc88c8c8c8c8c8c8c8c8cccc8888cc88c8c8c8c8c8c88888c8d4c15001488d4c0800188d4c08c00488c8c8c8c894cd4c0b003454cd4c1954cd4c194cc079402c004419c4ccd5cd19b8f00100706706615335306533223335530211200135025502423535506e001223335530241200135028502723535507100122333535502000123306d4800000488cc1b80080048cc1b4005200000133016002001333553021120015013503933020007500b006153353065333573466e214015208084af5f066067153353065333573466e20ccc040cc045402cd4d55418002888800d2201004881005002066067153353065333573466e20ccc040cc045402cd4d541ac0248800922010048810050030660671333573466e20ccc040ccd54c08448005404d40e4cc08001d402d221004881003370266e0540154009400c19819c4198419854cd4c194ccd5cd19b8833301033011500b35355506000a222003489004881005068066067153353065333573466e20ccc040cc045402cd4d541ac0248800922010048810050690660671333573466e20ccc040ccd54c08448005404d40e4cc08001d402d221004881003370266e05401541a141a419819c41984198419841984cc079402c01c4d4d541a54008880084d4d541a14004880044cd541a0cc17d4004d4d554170018888004cc17d4004d4d5419c014880044ccc02c005221004881001353024001220022223232300100532001355061223353502d0014800088d4d5418c008894cd4c17cccd5cd19b8f002009061060130070011300600332001355060223353502c0014800088d4d54188008894cd4c178ccd5cd19b8f00200706005f10011300600322353022002222222222233355301c12001500e50343355300d120012353550670012200133355301c120012235303200222253353503c0012135303b00422335305e0022008253353069333573466e3c0040501ac1a84cd40f0cd541c00100180204020401140d0024c8004d5416c8844894cd4d40a4004540ac884cd40b0c010008cd54c01848004010004488cd54c02c480048d4d5416c00488cd54178008cd54c038480048d4d5417800488cd54184008ccd4d540340048cc1612000001223305900200123305800148000004cc00c00800488cd54c028480048d4d5416800488cd54174008ccd4d540240048cd54c038480048d4d5417800488cd54184008d5404000400488ccd5540200400080048cd54c038480048d4d5417800488cd54184008d54038004004ccd55400c02c008004444888ccd54c03c480054098cd54c028480048d4d5416800488cd54174008d54030004ccd54c03c4800488d4d5416c008894cd4c15cccd54c04448004c8cd406088ccd4d402c00c88008008004d4d402400488004cd4024894cd4c164008416c40041608d4d5417800488cc028008014018400c4cd40a801000d409c004cd54c028480048d4d5416800488c8cd5417800cc004014c8004d54178894cd4d40a80044d5403000c884d4d54180008894cd4c170cc0300080204cd5404401c0044c01800c00848848cc00400c008480044484888c00c01044884888cc0080140104484888c004010448004c8004d541448844894cd4d407c00454084884cd4088c010008cd54c0184800401000488ccd5cd19b8f00200104c04b22353015002222222222253353502a33355300d120013350132253353502c002210031001502b253353054333573466e3c0300041581544d40b4004540b000c841584150c8004d5413888448894cd4d40740044d4d402800c88004884ccd4d403001488008c010008ccd54c01c4800401401000488d4c04c0048888888888ccd54c0344800488d4c08c008888d4c0ac00c88cd4c13800894cd4c164ccd5cd19b8f01400105b05a133502c0050071007200750250093200135504c221122253353501b0011002221330050023335530071200100500400113350052253353045002100110460451233500322333535006003220020020013535004001220011221233001003002120011221233001003002120012123001002200122212333001004003002200112200212200120012212330010030022001222222222212333333333300100b00a009008007006005004003002200122123300100300220012221233300100400300220011122002122122330010040031200122123300100300220011212230020031122001120011221233001003002120011221233001003002120011221233001003002120011212223003004112220021122200112001212222300400521222230030052122223002005212222300100520012212330010030022001212222222300700822122222223300600900821222222230050081222222200412222222003221222222233002009008221222222233001009008200121223002003222122333001005004003200121223002003212230010032001221233001003002200111122212333001004003002111200122337000040024466e0ccdc10012402800244666ae68cdc3801000802802091001091000900089a9aa801a8011100109a9aa801280091000899aa80124181dcda90604d06089109198008018010890008891918008009119801980100100099911991199119801199aaa80224411d7175e003e0749ce453fc419933297de37f4e859324dc79d1156b3699f900483403d20ae11335500648811d711eae0514665de6ac91a0ba5387e76474ebda9cc70c7301cb7a125261004828270048848cc00400c008800444488848ccc00401000c0084448004448848cc00400c0084480041"))),a},N=function(){return d.Z.Cardano.Address.from_bech32("addr_test1wrar7ewvyxc4h8sg9xgmk8kyyzlpktsmcpwnakp24nuh8ucma9934")},P=function(a){var e=a.tradeOwner,t=a.requestedAmount,r=a.privateRecip,n=d.Z.Cardano.PlutusList.new();n.add(d.Z.Cardano.PlutusData.new_bytes((0,s.H_)(e))),n.add(d.Z.Cardano.PlutusData.new_bytes(t)),n.add(d.Z.Cardano.PlutusData.new_bytes((0,s.H_)(r)));var c=d.Z.Cardano.PlutusList.new();return c.add(d.Z.Cardano.PlutusData.new_constr_plutus_data(d.Z.Cardano.ConstrPlutusData.new(d.Z.Cardano.Int.new_i32(0),n))),d.Z.Cardano.PlutusData.new_constr_plutus_data(d.Z.Cardano.ConstrPlutusData.new(d.Z.Cardano.Int.new_i32(B.Offer),c))},B={Offer:0},A=function(a){var e=d.Z.Cardano.PlutusData.new_constr_plutus_data(d.Z.Cardano.ConstrPlutusData.new(d.Z.Cardano.Int.new_i32(0),d.Z.Cardano.PlutusList.new()));return d.Z.Cardano.Redeemer.new(d.Z.Cardano.RedeemerTag.new_spend(),d.Z.Cardano.BigNum.from_str(a),e,d.Z.Cardano.ExUnits.new(d.Z.Cardano.BigNum.from_str("62200"),d.Z.Cardano.BigNum.from_str("18489133")))},E=function(a){var e=d.Z.Cardano.PlutusData.new_constr_plutus_data(d.Z.Cardano.ConstrPlutusData.new(d.Z.Cardano.Int.new_i32(1),d.Z.Cardano.PlutusList.new()));return d.Z.Cardano.Redeemer.new(d.Z.Cardano.RedeemerTag.new_spend(),d.Z.Cardano.BigNum.from_str(a),e,d.Z.Cardano.ExUnits.new(d.Z.Cardano.BigNum.from_str("62200"),d.Z.Cardano.BigNum.from_str("18489133")))},O=function(){function a(a){var e=a.base,t=a.projectId;this.provider={base:e,projectId:t}}var e=a.prototype;return e.blockfrostRequest=function(){var a=(0,r.Z)(c().mark((function a(e,t,r){return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(this.provider.base+e,{headers:Object.assign({project_id:this.provider.projectId},t,{"User-Agent":"cardano-escrow"}),method:r?"POST":"GET",body:r}).then((function(a){return a.json()}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a,this)})));return function(e,t,r){return a.apply(this,arguments)}}(),e.getUtxo=function(){var a=(0,r.Z)(c().mark((function a(e){var t;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.blockfrostRequest("/addresses/"+N().to_bech32()+"/utxos");case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var a=(0,r.Z)(c().mark((function a(t){return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((0,s.D)(t.amount)!=e){a.next=2;break}return a.abrupt("return",{offer:e,utxo:d.Z.Cardano.TransactionUnspentOutput.new(d.Z.Cardano.TransactionInput.new(d.Z.Cardano.TransactionHash.from_bytes((0,s.H_)(t.tx_hash)),t.output_index),d.Z.Cardano.TransactionOutput.new(N(),(0,s.D)(t.amount)))});case 2:throw new Error("The utxo value did not match the offer expected.");case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()));case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),e.initTx=function(){var a=(0,r.Z)(c().mark((function a(){var e,t,r,n,s;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=d.Z.Cardano.TransactionBuilder.new(d.Z.Cardano.LinearFee.new(d.Z.Cardano.BigNum.from_str(this.protocolParameters.linearFee.minFeeA),d.Z.Cardano.BigNum.from_str(this.protocolParameters.linearFee.minFeeB)),d.Z.Cardano.BigNum.from_str(this.protocolParameters.minUtxo),d.Z.Cardano.BigNum.from_str(this.protocolParameters.poolDeposit),d.Z.Cardano.BigNum.from_str(this.protocolParameters.keyDeposit),this.protocolParameters.maxValSize,this.protocolParameters.maxTxSize,this.protocolParameters.priceMem,this.protocolParameters.priceStep,d.Z.Cardano.LanguageViews.new(Buffer.from("a141005901d59f1a000302590001011a00060bc719026d00011a000249f01903e800011a000249f018201a0025cea81971f70419744d186419744d186419744d186419744d186419744d186419744d18641864186419744d18641a000249f018201a000249f018201a000249f018201a000249f01903e800011a000249f018201a000249f01903e800081a000242201a00067e2318760001011a000249f01903e800081a000249f01a0001b79818f7011a000249f0192710011a0002155e19052e011903e81a000249f01903e8011a000249f018201a000249f018201a000249f0182001011a000249f0011a000249f0041a000194af18f8011a000194af18f8011a0002377c190556011a0002bdea1901f1011a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000242201a00067e23187600010119f04c192bd200011a000249f018201a000242201a00067e2318760001011a000242201a00067e2318760001011a0025cea81971f704001a000141bb041a000249f019138800011a000249f018201a000302590001011a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a00330da70101ff","hex"))),r=d.Z.Cardano.PlutusList.new(),(e={})[406]={},n=e,s=d.Z.Cardano.TransactionOutputs.new(),a.abrupt("return",{txBuilder:t,datums:r,metadata:n,outputs:s});case 5:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}(),e.createOutput=function(a,e,t){var r=void 0===t?{}:t,n=r.datum,c=(r.index,r.tradeOwnerAddress),o=r.metadata,u=e,i=d.Z.Cardano.min_ada_required(u,d.Z.Cardano.BigNum.from_str(this.protocolParameters.minUtxo),n&&d.Z.Cardano.hash_plutus_data(n));1==i.compare(u.coin())&&u.set_coin(i);var f=d.Z.Cardano.TransactionOutput.new(a,u);return n&&f.set_data_hash(d.Z.Cardano.hash_plutus_data(n)),c&&(o[406].address="0x"+(0,s.NC)(c.to_address().to_bytes())),f},e.setCollateral=function(a,e){var t=d.Z.Cardano.TransactionInputs.new();e.forEach((function(a){t.add(a.input())})),a.set_collateral(t)},e.finalizeTx=function(){var a=(0,r.Z)(c().mark((function a(e){var t,r,n,o,u,i,f,m,l,p,_,b,h,w,C,g,Z,x,y,v,N,P,B,A,E,O,S,U,D,I=this;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:for(t=e.txBuilder,r=e.changeAddress,n=e.utxos,o=e.outputs,u=e.datums,i=e.metadata,f=e.scriptUtxo,m=e.action,l=d.Z.Cardano.TransactionWitnessSet.new(),p=k.randomImprove(n,o,8,f?[f]:[]),_=p.input,b=p.change,_.forEach((function(a){t.add_input(a.output().address(),a.input(),a.output().amount())})),h=0;h<o.len();h++)t.add_output(o.get(h));if(!f){a.next=21;break}return w=d.Z.Cardano.Redeemers.new(),C=t.index_of_input(f.input()).toString(),w.add(m(C)),t.set_redeemers(d.Z.Cardano.Redeemers.from_bytes(w.to_bytes())),t.set_plutus_data(d.Z.Cardano.PlutusList.from_bytes(u.to_bytes())),t.set_plutus_scripts(T()),a.next=14,window.cardano.getCollateral();case 14:if(!((g=a.sent.map((function(a){return d.Z.Cardano.TransactionUnspentOutput.from_bytes((0,s.H_)(a))}))).length<=0)){a.next=17;break}throw new Error("NO_COLLATERAL");case 17:this.setCollateral(t,g),l.set_plutus_scripts(T()),l.set_plutus_data(u),l.set_redeemers(w);case 21:if(i&&(Z=d.Z.Cardano.AuxiliaryData.new(),x=d.Z.Cardano.GeneralTransactionMetadata.new(),Object.keys(i).forEach((function(a){Object.keys(i[a]).length>0&&x.insert(d.Z.Cardano.BigNum.from_str(a),d.Z.Cardano.encode_json_str_to_metadatum(JSON.stringify(i[a]),1))})),Z.set_metadata(x),t.set_auxiliary_data(Z)),(y=b.multiasset())&&2*b.to_bytes().length>this.protocolParameters.maxValSize&&(v=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0")),N=d.Z.Cardano.MultiAsset.new(),P=y.keys(),function(){for(var a=0;a<y.len();a++){for(var e=P.get(a),t=y.get(e),r=t.keys(),n=d.Z.Cardano.Assets.new(),c=0;c<r.len();c++){var s=r.get(c),o=t.get(s);n.insert(s,o);var u=d.Z.Cardano.MultiAsset.from_bytes(N.to_bytes());u.insert(e,n);var i=d.Z.Cardano.Value.new(d.Z.Cardano.BigNum.from_str("0"));if(i.set_multiasset(u),2*i.to_bytes().length>=I.protocolParameters.maxValSize)return void N.insert(e,n)}N.insert(e,n)}}(),v.set_multiasset(N),B=d.Z.Cardano.min_ada_required(v,d.Z.Cardano.BigNum.from_str(this.protocolParameters.minUtxo)),v.set_coin(B),t.add_output(d.Z.Cardano.TransactionOutput.new(r.to_address(),v))),t.add_change_if_needed(r.to_address()),A=t.build(),E=d.Z.Cardano.Transaction.new(A,d.Z.Cardano.TransactionWitnessSet.from_bytes(l.to_bytes()),Z),O=2*E.to_bytes().length,console.log(O),!(O>this.protocolParameters.maxTxSize)){a.next=31;break}throw new Error("MAX_SIZE_REACHED");case 31:return a.next=33,window.cardano.signTx((0,s.NC)(E.to_bytes()),!0);case 33:return S=a.sent,S=d.Z.Cardano.TransactionWitnessSet.from_bytes((0,s.H_)(S)),l.set_vkeys(S.vkeys()),U=d.Z.Cardano.Transaction.new(E.body(),l,E.auxiliary_data()),console.log("Full Tx Size",U.to_bytes().length),a.next=40,window.cardano.submitTx((0,s.NC)(U.to_bytes()));case 40:return D=a.sent,a.abrupt("return",D);case 42:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),e.load=function(){var a=(0,r.Z)(c().mark((function a(){var e;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,d.Z.load();case 2:return a.next=4,this.blockfrostRequest("/epochs/latest/parameters");case 4:e=a.sent,console.log(JSON.stringify(e)),this.protocolParameters={linearFee:{minFeeA:e.min_fee_a.toString(),minFeeB:e.min_fee_b.toString()},minUtxo:"1000000",poolDeposit:"500000000",keyDeposit:"2000000",maxValSize:"5000",maxTxSize:16384,priceMem:.0577,priceStep:721e-7},this.contractInfo={owner1:{address:d.Z.Cardano.Address.from_bech32("addr1w967qqlqwjwwg5lugxvnx2taudl5apvnynw8n5g4dvmfn7g0j8gtz"),fee1:d.Z.Cardano.BigNum.from_str("1000"),fee2:d.Z.Cardano.BigNum.from_str("1111")},owner2:{address:d.Z.Cardano.Address.from_bech32("addr1wy02upg5vew7dty35za98pl8v36whk5ucux8xqwt0gf9ycglp29ku"),fee:d.Z.Cardano.BigNum.from_str("10000")}},k.setProtocolParameters(this.protocolParameters.minUtxo,this.protocolParameters.linearFee.minFeeA,this.protocolParameters.linearFee.minFeeB,this.protocolParameters.maxTxSize.toString());case 9:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}(),e.offer=function(){var a=(0,r.Z)(c().mark((function a(e,t,r){var n,o,u,i,f,m,l,p,_;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.initTx();case 2:return n=a.sent,o=n.txBuilder,u=n.datums,i=n.metadata,f=n.outputs,a.t0=d.Z.Cardano.BaseAddress,a.t1=d.Z.Cardano.Address,a.t2=s.H_,a.next=12,window.cardano.getUsedAddresses();case 12:return a.t3=a.sent[0],a.t4=(0,a.t2)(a.t3),a.t5=a.t1.from_bytes.call(a.t1,a.t4),m=a.t0.from_address.call(a.t0,a.t5),a.next=18,window.cardano.getUtxos();case 18:return l=a.sent.map((function(a){return d.Z.Cardano.TransactionUnspentOutput.from_bytes((0,s.H_)(a))})),p=P({tradeOwner:(0,s.NC)(m.payment_cred().to_keyhash().to_bytes()),requestedAmount:t,privateRecip:""==r?(0,s.NC)(m.payment_cred().to_keyhash().to_bytes()):r}),f.add(this.createOutput(N(),e,{datum:p,index:0,tradeOwnerAddress:m,metadata:i})),u.add(p),a.next=24,this.finalizeTx({txBuilder:o,changeAddress:m,utxos:l,outputs:f,datums:u,metadata:i});case 24:return _=a.sent,a.abrupt("return",_);case 26:case"end":return a.stop()}}),a,this)})));return function(e,t,r){return a.apply(this,arguments)}}(),e.getOffer=function(){var a=(0,r.Z)(c().mark((function a(e){var t;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.getUtxo(e);case 2:if(1!==(t=a.sent).length){a.next=5;break}return a.abrupt("return",t[0]);case 5:return a.abrupt("return",null);case 6:case"end":return a.stop()}}),a,this)})));return function(e){return a.apply(this,arguments)}}(),e.purchase=function(){var a=(0,r.Z)(c().mark((function a(e,t,r){var n,o,u,i,f,m,l,p,_,b,h;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.initTx();case 2:return n=a.sent,o=n.txBuilder,u=n.datums,i=n.outputs,a.t0=d.Z.Cardano.BaseAddress,a.t1=d.Z.Cardano.RewardAddress,a.t2=s.H_,a.next=11,window.cardano.getUsedAddresses();case 11:return a.t3=a.sent[0],a.t4=(0,a.t2)(a.t3),a.t5=a.t1.from_bytes.call(a.t1,a.t4),f=a.t0.from_address.call(a.t0,a.t5),a.next=17,window.cardano.getUtxos();case 17:return m=a.sent.map((function(a){return d.Z.Cardano.TransactionUnspentOutput.from_bytes((0,s.H_)(a))})),l=this.getOffer(t),p=P({tradeOwner:(0,s.NC)(e.payment_cred().to_keyhash().to_bytes()),requestedAmount:r,privateRecip:(0,s.NC)(e.payment_cred().to_keyhash().to_bytes())}),u.add(p),_=l.output().amount(),i.add(this.createOutput(f.to_address(),_)),i.add(this.createOutput(this.contractInfo.owner1.address,(0,s.D)([{unit:"lovelace",quantity:"4000000"}]))),i.add(this.createOutput(this.contractInfo.owner2.address,(0,s.D)([{unit:"lovelace",quantity:"1000000"}]))),(b=d.Z.Cardano.Ed25519KeyHashes.new()).add(f.payment_cred().to_keyhash()),o.set_required_signers(b),a.next=30,this.finalizeTx({txBuilder:o,changeAddress:f,utxos:m,outputs:i,datums:u,scriptUtxo:l.utxo,action:A});case 30:return h=a.sent,a.abrupt("return",h);case 32:case"end":return a.stop()}}),a,this)})));return function(e,t,r){return a.apply(this,arguments)}}(),e.cancelOffer=function(){var a=(0,r.Z)(c().mark((function a(e,t,r){var n,o,u,i,f,m,l,p,_,b,h;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.initTx();case 2:return n=a.sent,o=n.txBuilder,u=n.datums,i=n.outputs,a.t0=d.Z.Cardano.BaseAddress,a.t1=d.Z.Cardano.Address,a.t2=s.H_,a.next=11,window.cardano.getUsedAddresses();case 11:return a.t3=a.sent[0],a.t4=(0,a.t2)(a.t3),a.t5=a.t1.from_bytes.call(a.t1,a.t4),f=a.t0.from_address.call(a.t0,a.t5),a.next=17,window.cardano.getUtxos();case 17:return m=a.sent.map((function(a){return d.Z.Cardano.TransactionUnspentOutput.from_bytes((0,s.H_)(a))})),l=this.getOffer(t),p=P({tradeOwner:(0,s.NC)(e.payment_cred().to_keyhash().to_bytes()),requestedAmount:r,privateRecip:(0,s.NC)(e.payment_cred().to_keyhash().to_bytes())}),u.add(p),_=l.output().amount(),i.add(this.createOutput(f.to_address(),_)),(b=d.Z.Cardano.Ed25519KeyHashes.new()).add(f.payment_cred().to_keyhash()),o.set_required_signers(b),a.next=28,this.finalizeTx({txBuilder:o,changeAddress:f,utxos:m,outputs:i,datums:u,scriptUtxo:l,action:E});case 28:return h=a.sent,a.abrupt("return",h);case 30:case"end":return a.stop()}}),a,this)})));return function(e,t,r){return a.apply(this,arguments)}}(),a}(),S=O},2081:function(a,e,t){var r=t(5861),n=t(3144),c=t(7757),d=t.n(c),s=function(){function a(){}return a.prototype.load=function(){var a=(0,r.Z)(d().mark((function a(){return d().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._wasm){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,Promise.all([t.e(973),t.e(939)]).then(t.bind(t,1225));case 4:this._wasm=a.sent;case 5:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}(),(0,n.Z)(a,[{key:"Cardano",get:function(){return this._wasm}}]),a}();e.Z=new s},3427:function(a,e,t){t.d(e,{H_:function(){return d},NC:function(){return s},PX:function(){return o},D:function(){return u}});var r=t(2982),n=t(2426),c=t(2081),d=function(a){return n.lW.from(a,"hex")},s=function(a){return n.lW.from(a).toString("hex")},o=function(a){return n.lW.from(a).toString("hex")},u=function(a){var e=c.Z.Cardano.MultiAsset.new(),t=a.find((function(a){return"lovelace"===a.unit}));(0,r.Z)(new Set(a.filter((function(a){return"lovelace"!==a.unit})).map((function(a){return a.unit.slice(0,56)})))).forEach((function(t){var r=a.filter((function(a){return a.unit.slice(0,56)===t})),d=c.Z.Cardano.Assets.new();r.forEach((function(a){d.insert(c.Z.Cardano.AssetName.new(n.lW.from(a.unit.slice(56),"hex")),c.Z.Cardano.BigNum.from_str(a.quantity))})),e.insert(c.Z.Cardano.ScriptHash.from_bytes(n.lW.from(t,"hex")),d)}));var d=c.Z.Cardano.Value.new(c.Z.Cardano.BigNum.from_str(t?t.quantity:"0"));return(a.length>1||!t)&&d.set_multiasset(e),d}}}]);
//# sourceMappingURL=ee57c9ba743e71c4bbae5383b7d5422910dfe089-4c9df35318478c43cd22.js.map